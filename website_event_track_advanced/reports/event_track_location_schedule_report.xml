<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <report
            id="report_event_track_location_schedule_report"
            string="Location schedule"
            model="event.track.location"
            report_type="qweb-pdf"
            file="website_event_track_advanced.event_track_location_schedule_report"
            name="website_event_track_advanced.event_track_location_schedule_report"
            paperformat="event.paperformat_euro_lowmargin"
    />

    <template id="website_event_track_advanced.event_track_location_schedule_report">

        <t t-call="report.html_container">
            <t t-foreach="docs" t-as="doc">
                <div class="page">
                    <style type="text/css">
                        table {
                            border-collapse: collapse;
                        }
                        th {
                            padding-top: 2em;
                        }
                        td {
                            border: 1px dotted #555;
                            padding: 1em 2em;
                            white-space: nowrap;
                        }
                    </style>

                    <div class="oe_structure"/>
                    <h1 t-field="doc.name" />

                    <table name="track_schedule_table" class="table table-condensed">
                        <t t-set="date" t-value="false" />
                        <tbody>

                            <t t-foreach="doc.track_ids" t-as="track">
                                <t t-if="track.date" t-set="current" t-value="track.date[0:10]" />

                                <t t-if="not date or current != date">
                                    <tr>
                                        <t t-if="track.date" t-set="date" t-value="track.date[0:10]" />
                                        <th colspan="2">
                                            <h2>Program <span t-field="track.date" t-field-options='{"format": "dd.MM.YYYY"}' /></h2>
                                        </th>
                                    </tr>
                                </t>

                                <t t-if="track.type.attendable">
                                    <tr>
                                        <td>
                                            <span t-field="track.date" t-field-options='{"format": "HH:mm"}' /> - <span t-field="track.date_end" t-field-options='{"format": "HH:mm"}' />
                                        </td>
                                        <td><span t-field="track.name"/></td>
                                    </tr>
                                </t>
                            </t>
                        </tbody>
                    </table>
                </div>
            </t>
        </t>
    </template>

</odoo>